avocado %>% group_by(region,year) %>% summarise(avgprice = mean(AveragePrice)) ggplot(aes(avgprice,year,color=year))+geom_line()
avocado %>% group_by(region,year) %>% summarise(avgprice = mean(AveragePrice)) %>% ggplot(aes(avgprice,year,color=year))+geom_line()
avocado %>% group_by(region,year) %>% summarise(avgprice = mean(AveragePrice)) %>% ggplot(aes(year,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>% summarise(avgprice = mean(AveragePrice)) %>% ggplot(aes(year,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice),AsDate = as.POSIXct(Date)) %>%
ggplot(aes(Date,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice),AsDate = as.POSIXct(Date)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>% mutate(AsDate <- as.POSIXct(Date)) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>% mutate(AsDate <- as.POSIXct(Date))
avocado %>% group_by(year) %>% mutate(AsDate = as.POSIXct(Date)) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>% mutate(AsDate = as.POSIXct(Date)
avocado %>% group_by(year) %>% mutate(AsDate = as.POSIXct(Date)) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>% mutate(AsDate = as.POSIXct(Date))
as.POSIXct(avocado$Date[1])
avocado %>% group_by(year) %>% mutate(AsDate = as.POSIXct(Date)) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado$Date[1]
as.POSIXct(avocado$Date[1])
as.POSIXlt(avocado$Date[1])
avocado  %>% mutate(AsDate = as.POSIXct(Date))
avocado  %>% mutate(AsDate = as.POSIXct(Date)) %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado  %>% mutate(AsDate = as.POSIXct(Date)) %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(AsDate,avgprice,color=year))+geom_line()
avocado  %>% mutate(AsDate = as.POSIXct(Date)) %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice,color=year))+geom_line()
avocado  %>% mutate(AsDate = as.POSIXct(Date)) %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice)) %>% ggplot(aes(Date,avgprice,color=year))+geom_line()
avocado  %>% mutate(AsDate = as.POSIXct(Date)) %>% group_by(year) %>%  summarise(avgprice = mean(AveragePrice)) %>% ggplot(aes(Date,avgprice,color=year))+geom_line()
avocado %>% group_by(year) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(year,avgprice,color=year))+geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(year,avgprice,color=year))+geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice,color=year))+geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice,color=Date))+geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice))+geom_line()
avocado$Date <- as.POSIXct(avocado$Date)
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice))+geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice))+geom_line()+facet_grid(type ~ year ,scales = free)
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice))+geom_line()+facet_grid(type ~ year ,scales = 'free')
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date,avgprice,color='type'))+geom_line()+facet_grid(type ~ year ,scales = 'free')
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(type, avgprice, color = 'type')) + geom_line() + facet_grid(type ~ year , scales = 'free')
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(type, avgprice, color = 'type')) + geom_line()
View(avocado)
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice, color = 'type')) + geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice, color = type)) + geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice, color = type)) + geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice, fill = type)) + geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice, fill = year)) + geom_line()
avocado %>% group_by(Date) %>%
summarise(avgprice = mean(AveragePrice)) %>%
ggplot(aes(Date, avgprice)) + geom_line()
avocado %>% group_by(region,year)
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice))
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) +
ggplot(aes(region,mean_price,fill=year)) + geom_point()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(region,mean_price,fill=year)) + geom_point()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(region,mean_price,fill=year)) + geom_box()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(region,mean_price,fill=year)) + geom_bar()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(region,mean_price,fill=year)) + geom_bar(stat='identity')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice))
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(mean_price,year,fill=region)) + geom_bar(stat='identity')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(mean_price,year,fill=region)) + geom_point()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_point()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line() + geom_smooth(method = 'lm')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% filter(region='chicago')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% filter(region=='chicago')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% filter(region=='Chicago')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% filter(region=='Chicago') %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line() + geom_smooth(method = 'lm')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line() + geom_smooth(method = 'lm')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=year,color=region)) + geom_line()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10)
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,color=year)) + geom_bar()
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,color=year)) + geom_bar(stat='identiti')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,color=year)) + geom_bar(stat='identity')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=year)) + geom_bar(stat='identity')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=year,fill=region)) + geom_bar(stat='identity')
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10)
?arrange
avocado %>% group_by(region,year) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price))
avocado %>% group_by(year,region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price))
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total))
avocado %>% group_by(year,region) %>% summarise(Avg_total = dollar(mean(Total.Volume))) %>% arrange(desc(Avg_total))
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total))
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total)) %>% head(10) %>%
ggplot(aes(y=Avg_total,x=year,fill=region)) + geom_bar(stat='identity')
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total)) %>% head(10) %>%
ggplot(aes(y=Avg_total,x=year,fill=region)) + geom_bar(stat='identity') + facet_grid(year ~ region)
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total)) %>% head(20) %>%
ggplot(aes(y=Avg_total,x=year,fill=region)) + geom_bar(stat='identity') + facet_grid(year ~ region)
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total))
avocado %>% group_by(year,region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total))
avocado %>% group_by(region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total)
avocado %>% group_by(region) %>% summarise(Avg_total = mean(Total.Volume)) %>% arrange(desc(Avg_total))
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(Avg_total)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity') + facet_grid(year ~ region)
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity') + facet_grid(year ~ region)
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity')
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Price')
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price')
avocado %>% group_by(region) %>% summarise(mean_price = mean(AveragePrice)) %>% arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) + geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price') +
theme(axis.text.x = element_text(angle=90))
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice)) %>%
arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) +
geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price') +
theme(axis.text.x = element_text(angle=90))
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice*Total.Volume)) %>%
arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) +
geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price') +
theme(axis.text.x = element_text(angle=90))
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice*Total.Volume)) %>%
arrange(desc(mean_price)) %>% head(10)
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice*Total.Volume)) %>%
arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=dollar(mean_price),x=region,fill=region)) +
geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price') +
theme(axis.text.x = element_text(angle=90))
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice*Total.Volume)) %>%
arrange(desc(mean_price)) %>% head(10)
avocado %>% group_by(region) %>%
summarise(mean_price = mean(AveragePrice)) %>%
arrange(desc(mean_price)) %>% head(10) %>%
ggplot(aes(y=mean_price,x=region,fill=region)) +
geom_bar(stat='identity') +
labs(title = 'Top 10 Performing Markets over the years',x='Regions',y='Mean Average Price') +
theme(axis.text.x = element_text(angle=90))
avocado %>% group_by(year)
avocado %>% group_by(year) %>% summarise(avg_volume = mean(Total.Volume))
avocado %>% group_by(year) %>% summarise(avg_volume = mean(as.numeric(Total.Volume))
most_volatile <- avocado %>% group_by(region,type,year) %>% summarise(sd=sd(AveragePrice),min_pr = min(AveragePrice),max_pr =max(AveragePrice),spread=max_pr-min_pr) %>% arrange(desc(sd))
most_volatile_org <-
most_volatile %>% filter(type == 'organic') %>% mutate(
sd = dollar(sd),
min_pr = dollar(min_pr),
max_pr = dollar(max_pr),
spread = dollar(spread)
)
most_volatile_con <-
most_volatile %>% filter(type == 'conventional') %>% mutate(
sd = dollar(sd),
min_pr = dollar(min_pr),
max_pr = dollar(max_pr),
spread = dollar(spread)
)
average_price <- avocado %>% filter(region == 'Chicago') %>% mutate(qtr = quarter(Date,with_year='F'))
date_ranges <- paste(min(avocado$Date) , '-',max(avocado$Date))
ggplot(average_price,
aes(as.factor(qtr), AveragePrice, group = as.factor(qtr)),
color = 'type') +
geom_boxplot(
fill = 'white',
alpha = .3,
outlier.shape = NA,
color = 'red',
outlier.colour = 'blue'
) +
geom_jitter(stat = 'identity', width = 0.25, size = 1.8) + theme_bw() +
facet_grid(type ~ year, scales = 'free') +
scale_y_continuous(breaks = seq(0, 3, .2)) + scale_x_discrete(drop = F) +
labs(
title = 'Avg price of single avocado : Chicago',
subtitle = paste('By Quarter of the year |', ' Dates from ', date_ranges),
x='Quarter of the year',
y= 'Average Price'
)
avocado %>% group_by(year) %>% summarise(avg_volume = mean(Total.Volume))
avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume))
x <- avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume))
x <- avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume)) %>% arrange(desc(avg_volume))
x
x <- x[,head(region,10),by=year]
x <- by(x,x["region"],head(10),n=10)
x <- by(x,x["region"],head(10),n=10)
x <- avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume)) %>% arrange(desc(avg_volume)) %>% slice(1:2)
x
x <- avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume)) %>% arrange(desc(avg_volume)) %>% slice(1:10)
x
View(x)
?slice
x <- avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume))
x
avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume)) %>% arrange(desc(avg_volume))
avocado %>% group_by(year,region) %>% summarise(avg_volume = mean(Total.Volume)) %>% arrange(desc(avg_volume)) %>% slice(1:10) %>% arrange(desc(avg_volume))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:10) %>% arrange(desc(avg_volume))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(avg_volume))
avocado %>% filter(year==2018) %>% summarise(y = mean(Total.Volume)) %>% arrange(desc(y))
avocado %>% group_by(region) %>% filter(year==2018) %>% summarise(y = mean(Total.Volume)) %>% arrange(desc(y))
avocado %>% group_by(region) %>% filter(year==2018) %>% summarise(y = mean(Total.Volume)) %>% arrange(desc(y)) %>% head(5)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(avg_volume))
avocado %>% group_by(region) %>% filter(year==2018) %>% summarise(y = mean(Total.Volume)) %>% arrange(desc(y)) %>% head(5)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,color=region))+geom_point()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,color=region))+geom_bar(stat='identity')
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_bar(stat='identity')
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(region~year)
avocado %>% group_by(year, region,type) %>% summarise(avg_volume = mean(Total.Volume))
avocado %>% group_by(year, region,type) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_boxplot(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_boxplot() +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_bar() +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(region,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,reorder(avg_volume,year),fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(scales::comma())
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(scales::comma
most_volatile <- avocado %>% group_by(region,type,year) %>% summarise(sd=sd(AveragePrice),min_pr = min(AveragePrice),max_pr =max(AveragePrice),spread=max_pr-min_pr) %>% arrange(desc(sd))
most_volatile_org <-
most_volatile %>% filter(type == 'organic') %>% mutate(
sd = dollar(sd),
min_pr = dollar(min_pr),
max_pr = dollar(max_pr),
spread = dollar(spread)
)
most_volatile_con <-
most_volatile %>% filter(type == 'conventional') %>% mutate(
sd = dollar(sd),
min_pr = dollar(min_pr),
max_pr = dollar(max_pr),
spread = dollar(spread)
)
average_price <- avocado %>% filter(region == 'Chicago') %>% mutate(qtr = quarter(Date,with_year='F'))
date_ranges <- paste(min(avocado$Date) , '-',max(avocado$Date))
ggplot(average_price,
aes(as.factor(qtr), AveragePrice, group = as.factor(qtr)),
color = 'type') +
geom_boxplot(
fill = 'white',
alpha = .3,
outlier.shape = NA,
color = 'red',
outlier.colour = 'blue'
) +
geom_jitter(stat = 'identity', width = 0.25, size = 1.8) + theme_bw() +
facet_grid(type ~ year, scales = 'free') +
scale_y_continuous(breaks = seq(0, 3, .2)) + scale_x_discrete(drop = F) +
labs(
title = 'Avg price of single avocado : Chicago',
subtitle = paste('By Quarter of the year |', ' Dates from ', date_ranges),
x='Quarter of the year',
y= 'Average Price'
)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(scales::comma)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(scales::dollar)
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(seq(0,200000,50000))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(breaks=seq(0,200000,50000))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(breaks=seq(0,200000,50000))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(breaks=seq(0,2000000,50000))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous(breaks=seq(0,2000000,5000000))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>% arrange(desc(year,avg_volume)) %>%
ggplot(aes(year,avg_volume,fill=region))+geom_bar(stat='identity') +
facet_grid(year~region) + scale_y_continuous() + coord_flip()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous()
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
labs(title = 'Avg volumes of Top regions over the years' )
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
labs(title = 'Avg volumes of Top regions over the years' )+
theme(plot.margin = element_text(hjus=0.5))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
labs(title = 'Avg volumes of Top regions over the years' )+
theme(plot.margin = element_text(hjust=0.5))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
theme(plot.title = 'Avg volumes of Top regions over the years', plot.margin = element_text(hjust=0.5))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
theme(plot.title = element_text('Avg volumes of Top regions over the years'), plot.margin = element_text(hjust=0.5))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
theme(plot.title = element_text('Avg volumes of Top regions over the years',hjust = 0.5))
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
labs(title = 'Avg volumes of Top regions over the years' )
avocado %>% group_by(year, region) %>% summarise(avg_volume = mean(Total.Volume)) %>%
arrange(desc(avg_volume)) %>% slice(1:5) %>%
arrange(desc(year, avg_volume)) %>%
ggplot(aes(year, avg_volume, fill = region)) +
geom_bar(stat = 'identity') +
facet_grid(year ~ region) + scale_y_continuous() +
labs(title = 'Avg volumes of Top 5 regions over the years' )
avocado %>% group_by(type,year) %>% summarise(avg_price = mean(AveragePrice))
avocado %>% group_by(type,year) %>% summarise(avg_price = mean(AveragePrice)) %>%
ggplot(aes(year,avg_price,color=type)) + geom_point()
avocado %>% group_by(type,year) %>% summarise(avg_price = mean(AveragePrice)) %>%
ggplot(aes(year,avg_price,color=type)) + geom_line()
avocado %>% group_by(type,year) %>% summarise(avg_price = mean(Total.Volume)) %>%
ggplot(aes(year,avg_price,color=type)) + geom_line()
avocado %>% group_by(type,year) %>% summarise(avg_price = mean(AveragePrice)) %>%
ggplot(aes(year,avg_price,color=type)) + geom_line()
ggplot(average_price,
aes(as.factor(qtr), AveragePrice, group = as.factor(qtr)),
color = 'type') +
geom_boxplot(
fill = 'white',
alpha = .3,
outlier.shape = NA,
color = 'red',
outlier.colour = 'blue'
) +
geom_jitter(stat = 'identity', width = 0.25, size = 1.8) + theme_bw() +
facet_grid(type ~ year, scales = 'free') +
scale_y_continuous(breaks = seq(0, 3, .2)) + scale_x_discrete(drop = F) +
labs(
title = 'Avg price of single avocado : Chicago',
subtitle = paste('By Quarter of the year |', ' Dates from ', date_ranges),
x='Quarter of the year',
y= 'Average Price'
)
